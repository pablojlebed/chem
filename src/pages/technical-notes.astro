---
// src/pages/tech-notes.astro
import { getCollection } from "astro:content";
import BaseLayout from "../layouts/BaseLayout.astro";

const allNotes = await getCollection("notes");

const sortedNotes = allNotes.sort(
  (a, b) => b.data.pubDate.getTime() - a.data.pubDate.getTime()
);

const formatDate = (date: Date) => {
  return date.toLocaleDateString("en-US", {
    year: "numeric",
    month: "long",
    day: "numeric",
  });
};
---

<BaseLayout
  title="Technical Notes - Pablo Lebed"
  description="A comprehensive collection of technical notes by Pablo Lebed."
  canonicalURL={Astro.url.href}
>
  <section class="py-12 md:py-16 text-center">
    <h1
      class="text-4xl md:text-5xl lg:text-6xl font-extrabold text-gray-900 leading-tight mb-6"
    >
      Technical Notes
    </h1>
    <p class="text-lg md:text-xl text-gray-700 mb-8 max-w-3xl mx-auto">
      This section is my personal knowledge hub, documenting insights and solutions from my professional journey as an analytical chemist. Here, you'll find resources ranging from deep dives into analytical instrumentation to method development best practices, quality assurance, knowledge management, and statistical process control (SPC).
    </p>
  </section>

  <section class="mt-12 md:mt-16 pb-16">
    <h2
      class="text-3xl font-bold text-gray-900 mb-6 pb-2 border-b border-gray-200 text-center"
    >
      Topics & Resources
    </h2>

    {
      sortedNotes.length === 0 ? (
        <p class="text-center text-gray-600 italic py-12">
          No technical notes found yet. Please check back later!
        </p>
      ) : (
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mt-8 max-w-5xl mx-auto px-4">
          {sortedNotes.map((note) => (
            <a
              href={`/tech-notes/${note.slug}`}
              class="group flex flex-col h-full bg-white border border-gray-100 p-4 rounded-lg shadow-sm hover:shadow-md hover:-translate-y-1 transition-all duration-200 !no-underline"
              aria-label={`Read technical note: ${note.data.title}`}
            >
              <div class="flex-grow">
                {note.data.heroImage && (
                  <div class="mb-4 flex justify-center bg-gray-50 rounded-md overflow-hidden">
                    <img
                      src={note.data.heroImage}
                      alt={`Hero image for ${note.data.title}`}
                      class="h-auto w-auto max-w-full max-h-60 object-contain transform group-hover:scale-105 transition-transform duration-300"
                      loading="lazy"
                    />
                  </div>
                )}

                <h3 class="text-xl font-bold text-gray-900 mb-2 group-hover:text-primary-blue transition-colors">
                  {note.data.title}
                </h3>

                {/* Removed 'line-clamp-3' to show full description */}
                <p class="text-sm text-gray-600 mb-4">
                  {note.data.description}
                </p>
              </div>

              <div class="pt-4 mt-auto border-t border-gray-100">
                <div class="flex flex-wrap gap-2 mb-2">
                  {note.data.tags.map((tag) => (
                    <span class="text-[10px] uppercase tracking-wider px-2 py-1 bg-gray-50 text-gray-600 rounded-md font-semibold border border-gray-200">
                      {tag}
                    </span>
                  ))}
                </div>
                {note.data.pubDate && (
                  <p class="text-xs text-gray-400 font-medium text-right">
                    {formatDate(note.data.pubDate)}
                  </p>
                )}
              </div>
            </a>
          ))}
        </div>
      )
    }
  </section>
</BaseLayout>
