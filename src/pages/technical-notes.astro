---
// src/pages/tech-notes.astro
import { getCollection } from "astro:content";
import BaseLayout from "@layouts/BaseLayout.astro";

const allNotes = await getCollection("notes");

const sortedNotes = allNotes.sort(
  (a, b) => b.data.pubDate.getTime() - a.data.pubDate.getTime(),
);

const formatDate = (date: Date) => {
  return date.toLocaleDateString("en-US", {
    year: "numeric",
    month: "long",
    day: "numeric",
  });
};
---

<BaseLayout
  title="Technical Notes - Pablo Lebed"
  description="A comprehensive collection of technical notes by Pablo Lebed."
  canonicalURL={Astro.url.href}
>
  <section class="max-w-3xl mx-auto py-12 md:py-16 px-4">
    <h1
      class="text-4xl md:text-5xl font-bold mb-6 pb-2 border-b border-tron-red/20"
    >
      Technical Notes
    </h1>
    <p class="text-lg md:text-xl mb-8 max-w-3xl mx-auto">
      This section is my personal knowledge hub, documenting insights and
      solutions from my professional journey as an analytical chemist. Here,
      you'll find resources ranging from deep dives into analytical
      instrumentation to method development best practices, quality assurance,
      knowledge management, and statistical process control (SPC).
    </p>
  </section>

  <section class="mt-12 md:mt-16 pb-16">
    <h2
      class="text-3xl font-bold mb-6 pb-2 border-b border-tron-red/20 text-center text-tron-red"
    >
      Topics & Resources
    </h2>

    {
      sortedNotes.length === 0 ? (
        <p class="text-center text-gray-400 italic py-12">
          No technical notes found yet. Please check back later!
        </p>
      ) : (
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mt-8 max-w-5xl mx-auto px-4">
          {sortedNotes.map((note) => (
            <a
              href={`/tech-notes/${note.slug}`}
              class="group flex flex-col h-full bg-tron-dark-200/40 backdrop-blur-sm border border-tron-red/20 p-4 rounded-lg shadow-[0_0_10px_rgba(255,0,51,0.05)] hover:shadow-[0_0_15px_rgba(255,0,51,0.2)] hover:border-tron-red/50 hover:-translate-y-1 transition-all duration-200 !no-underline"
              aria-label={`Read technical note: ${note.data.title}`}
            >
              <div class="flex-grow">
                {note.data.heroImage && (
                  <div class="mb-4 flex justify-center bg-gray-900/50 rounded-md overflow-hidden border border-tron-cyan/10">
                    <img
                      src={note.data.heroImage}
                      alt={`Hero image for ${note.data.title}`}
                      class="h-auto w-auto max-w-full max-h-60 object-contain transform group-hover:scale-105 transition-transform duration-300"
                      loading="lazy"
                    />
                  </div>
                )}

                <h3 class="text-xl font-bold text-tron-red mb-2 group-hover:text-white transition-colors">
                  {note.data.title}
                </h3>

                {/* Removed 'line-clamp-3' to show full description */}
                <p class="text-sm text-tron-cyan/80 mb-4 group-hover:text-tron-cyan transition-colors">
                  {note.data.description}
                </p>
              </div>

              <div class="pt-4 mt-auto border-t border-tron-red/10">
                <div class="flex flex-wrap gap-2 mb-2">
                  {note.data.tags.map((tag) => (
                    <span class="text-[10px] uppercase tracking-wider px-2 py-1 bg-tron-red/10 text-tron-red rounded-md font-semibold border border-tron-red/20 shadow-[0_0_5px_rgba(255,0,51,0.2)]">
                      {tag}
                    </span>
                  ))}
                </div>
                {note.data.pubDate && (
                  <p class="text-xs text-gray-500 font-medium text-right group-hover:text-gray-300 transition-colors">
                    {formatDate(note.data.pubDate)}
                  </p>
                )}
              </div>
            </a>
          ))}
        </div>
      )
    }
  </section>
</BaseLayout>
